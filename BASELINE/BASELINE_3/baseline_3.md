# Чекпоинт 3: BASELINE

## Эксперимент 1: Faster R-CNN

### Датасет (StanfordCarsDataset)

В эксперименте использовался кастомный датасет с 9 классами объектов + фон (итого 10 классов).

### Модель

Была выбрана архитектура `Faster R-CNN` с `ResNet50-FPN` в качестве backbone. Предобученные веса использовались только для backbone (ImageNet).

### Гиперпараметры и обучение

* **Loss**: стандартный `FasterRCNNLoss`, включающий классификацию и регрессию ббоксов
* **Оптимизатор**: SGD с параметрами:
  * `lr = 5e-3` (для обучения головы), `1e-3` (для fine-tune)
  * `momentum = 0.9`
  * `weight_decay = 5e-4`

#### Этап 1: Обучение только головы

* Загрузили COCO-веса
* Заменили head под 10 классов
* Заморозили backbone (только голова обучаема)
* Обучение: 3 эпохи

#### Этап 2: Fine-tune всей архитектуры

* Разморозили весь backbone
* Продолжили обучение еще на 3 эпохи с меньшим learning rate

### Оценка

#### Метрики (на валидации):

* **Precision**: `0.142`
* **Recall**: `0.573`
* **F1**: `0.228`

Оценка выполнялась при:
* **score_thresh** = `0.1` 
* **iou_thresh** = `0.5`

### Выводы

* При ограниченных ресурсах (обучено только 6 эпох) удалось достичь умеренного Recall, Precision пока низкая
* Модель обнаруживает объекты, но часто ошибается
* Проблема Precision может быть устранена постериорной обработкой и достройкой режима оценки
* Для достижения лучшего результата необходимо довести обучение до 10-20 эпох

### Файл с финальной моделью:

```
fasterrcnn_f1.23.pt (в BOT/models)
```

## Эксперимент 2: YOLOv5

### Датасет (StanfordCarsDataset)

Использовался тот же датасет с 9 классами объектов + фон (итого 10 классов).

### Модель

Использовалась архитектура `YOLOv5s` - компактная версия YOLOv5. Предобученные веса взяты с официального репозитория (предобучены на COCO).

### Гиперпараметры и обучение

* **Loss**: стандартный `YOLOv5Loss`, включающий:
  * box_loss
  * obj_loss
  * cls_loss
* **Оптимизатор**: SGD
* **Параметры обучения**:
  * Размер изображения: 640x640
  * Batch size: 16
  * Epochs: 3

### Оценка

#### Метрики (на валидации):

* **Precision**: `0.330`
* **Recall**: `0.584`
* **mAP@0.5**: `0.291`
* **mAP@0.5:0.95**: `0.243`

### Выводы

* YOLOv5 показала лучшие результаты по сравнению с Faster R-CNN за то же количество эпох (3)
* Значительно выше Precision (0.330 vs 0.142)
* Немного выше Recall (0.584 vs 0.573)
* Модель лучше обнаруживает и классифицирует объекты
* Для дальнейшего улучшения рекомендуется:
  * Увеличить количество эпох
  * Попробовать более крупные версии YOLOv5 (m, l, x)
  * Применить аугментации данных

### Файл с финальной моделью:

```
yolov5_f1.29.pt (в BOT/models)
```